openapi: 3.0.3
info:
  termsOfService: https://selfcare.notifichedigitali.it/termini-di-servizio
  x-api-id: api-external-b2b-pa
  title: 'Piattaforma Notifiche: API B2B per le Pubbliche Amministrazioni'
  x-summary: 'Piattaforma Notifiche: API B2B per le Pubbliche Amministrazioni'
  version: 1.0.0
  description: >-

    ## Abstract
      API utilizzate dalle pubbliche amministrazioni per __inviare richieste di notifiche__ e 
      __ottenere informazioni in modalità pull__ sullo stato della 
      _"richiesta di notifica"_ (accettata o rifiutata) e, in caso di richiesta accettata, 
      sulle comunicazioni effettuate, o solo tentate, nei confronti dei destinatari della notifica.

    ## Operazioni utilizzate, in sequenza temporale

    <table>

    <tr>

    <td>

     <img src="https://raw.githubusercontent.com/pagopa/pn-delivery/e6f1db9eac9ace7fc2ad0fe6de241ab4525b6b6a/docs/openapi/images/invio-notifica.png" height="790" width="515" alt="Invio notifica" />

       </br>
       </br>
       </br>
      
      #### 3. Verifica accettazione richiesta di invio notifica

      Per questa verifica possono essere utilizzate due modalità:
      
      1. __richiesta puntuale__: consigliato solo ai fini di test
      2. __lettura da stream configurato__: consigliato per ambienti di produzione
      
      La differenza tra le due modalità è nell'interazione e nell'efficienza.
      
      Con la modalità _"richiesta puntuale"_ è necessaria l'invocazione per ogni notifica,
      mentre con la modalità _"stream"_ è possibile avere gli aggiornamenti
      di stato di più notifiche con una sola invocazione.
      
      #### 3.1 Richiesta puntuale di verifica accettazione

      Questa modalità è resa disponibile solo ai fini di test o di eventuali operazioni
      di allineamento. Richiede l'invio di una richiesta per ogni notifica.
      Se il passo (2) avviene con successo si utilizza l'operazione 
      [getNotificationRequestStatus](#/SenderReadB2B/retrieveNotificationRequestStatusV23)
      per ottenere informazioni riguardo allo stato della "richiesta di invio di notifica". </br>
      Nel campo _notificationRequestStatus_ sarà indicato:</br>
      >\- <strong>WAITING:</strong> se la validazione è ancora in corso.</br>
      \- <strong>ACCEPTED:</strong> se richiesta di notifica accettata, lo _IUN_ è valorizzato.</br>
      \- <strong>REFUSED:</strong> se richiesta di notifica rifiutata, è valorizzato il campo _errors_.</br>
      </br>
      </br>
      </br>

      #### 3.2 Richiesta avanzamento via "stream" di verifica di accettazione

      Questa è la modalità consigliata. Per essere utilizzata è necessaria un'operazione preliminare
      tramite la chiamata alla API [createEventStream](https://petstore.swagger.io/?url=https%3A%2F%2Fraw.githubusercontent.com%2Fpagopa%2Fpn-delivery-push%2Fmain%2Fdocs%2Fopenapi%2Fapi-external-b2b-webhook.yaml#/Streams/createEventStream)
      per configurare uno "stream" che registri il cambio di stato della notifica con il seguente payload:</br></br>``
      {
        "title": "NotificationAccepted",
        "eventType": "STATUS",
        "filterValues": [
          "ACCEPTED"
        ]
      }
      ``</br></br>
      Successivamente si possono ottenere i dati richiamando la API [consumeEventStream](https://petstore.swagger.io/?url=https%3A%2F%2Fraw.githubusercontent.com%2Fpagopa%2Fpn-delivery-push%2Fmain%2Fdocs%2Fopenapi%2Fapi-external-b2b-webhook.yaml#/Events/consumeEventStream)
      
      
      __NOTA__ saranno disponibili i dati di cambiamento di stato occorsi solo successivamente alla configurazione
      dello stream.
      
      </br>
      </br>
      </br>
      </br>
      
    </td>

    <td>

      ### Ciclo di vita della notifica lato mittente
      
      #### 1. Caricamento dei documenti della notifica

      Prima di invocare la richiesta di notifica è necessario caricare i documenti della notifica (documenti e bollettini/metadata di pagamento).
      [Schema Metadata F24](#/components/schemas/F24Metadata)

      #### 1.a. Richiesta presigned Url
      
      Invocare l'operazione [presignedUploadRequest](#/NewNotification/presignedUploadRequest) 
      con cui prenotare il caricamento. Possono essere effettuate un massimo di <span id="numberOfPresignedRequest">15</span> prenotazioni di caricamento
      per ogni richiesta.</br>
      In risposta si ottengono le seguenti informazioni:<br/>
      \- httpMethod <br/>
      \- secret <br/>
      \- url <br/>
      L'url restituito ha una validità di 1h.
      
      </br>

      #### 1.b Upload documenti della notifica
      
      Per ogni documento utilizzare un richiesta HTTP con metodo _httpMethod_ (POST o PUT) 
      all'url indicato dal campo _url_. <br/>
      In tale richiesta vanno aggiunti i seguenti header: <br/>
      \- _content-type_: valorizzato come il campo "contentType" della richiesta di cui al punto (1.a) <br/>
      \- _x-amz-meta-secret_: valorizzato con il valore del campo "secret" della risposta di cui al punto (1.a) <br/>
      \- _trailer_: valorizzato con ```x-amz-checksum-sha256``` <br/>
      \- _x-amz-checksum-sha256_: valorizzato con il checksum sha256, codificato in base 64, del contenuto binario del file che verrà caricato. (__N.B.__ questo è un trailer HTTP non un header).
        Vedi [HTTP Trailer](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Trailer) <br/>
        __NOTA:__ se l'operazione di upload è stata eseguita con successo, si otterrà come risposta _status 200 OK_. <br/>
        Nell'header di questa risposta, si otterrà il campo __x-amz-version-id__ che dovrà essere utilizzato durante <br/> 
        l'inserimento della notifica, nel campo ref.__versionToken__ in corrispondenza del documento ad esso associato.

     
      </br>
      </br>
      </br>
      
      #### 2. Richiesta di invio della notifica

      Per effettuare una richiesta di invio notifica, invocare l'operazione 
      [sendNewNotification](#/NewNotification/sendNewNotificationV21) valorizzando il campo <b>payments</b> (scegliendo in base alla tipologia di file caricato <b>F24</b>/<b>pagoPa</b>) e il campo <b>documents</b> utilizzando i riferimenti dei file
        caricati in precedenza nel seguente:
        <br>
        - <b>digests.sha256 </b>: SHA256 associato all'allegato caricato
        - <b>contentType </b>: in caso la tipologia dell'allegato fosse <b>documento</b> e <b>avviso di pagamento</b> dovrà essere popolato con "application/pdf" in caso di <b>F24</b> invece dovrà contenere "application/json"
        - <b>ref.key</b>: key ottenuta nella response della chiamata [presignedUploadRequest](#/NewNotification/presignedUploadRequest)
        - <b>ref.versionToken</b>: valore dell'header x-amz-version-id ottenuto dalla response in fase di upload dell'allegato ad esso associato.
        </br>
        Nel caso si voglia valorizzare il campo <b>payments</b>  con un bolletino di pagamento <b>pagoPa</b> oltre al riferimento al file tramite la sezione <b>pagoPaForm</b> con le indicazioni riportate sopra, sono da valorizzare i campi <b>noticeCode</b> "codice avviso pagoPA" ,univoco, di pagamento del sistema pagoPA utilizzato , usato per pagamento online;
        <b> creditorTaxId</b>: codice fiscale dell'ente a cui fa riferimento il "codice avviso pagoPA"; il campo
        <b>applyCost</b>: flag per indicare se l'avviso pagoPA deve contenere i costi di notifica e il campo
        </br>
        Nel caso,invece, nel campo payments si voglia valorizzare un pagamento <b>F24</b>,oltre al riferimento al file caricato tramite la sezione <b>metadataAttachment</b> con le indicazioni riportate sopra, sono da valorizzare i campi <b> title</b>: titolo del documento pdf da mostrare all'utente e
          <b>applyCost</b>: flag per indicare se il modello F24 deve contenere i costi di notifica.

      </br>
      </br>
      </br>

       <img src="https://raw.githubusercontent.com/pagopa/pn-delivery/e6f1db9eac9ace7fc2ad0fe6de241ab4525b6b6a/docs/openapi/images/verifica-accettazione-richiesta-invio.png" height="731" width="489" alt="Verifica accettazione richiesta" />
    </td>
      
    </tr>

    </table>


      ### 4. Monitorare l'avanzamento di una notifica

      Per questa verifica possono essere utilizzate due modalità:
            1. __monitoraggio puntuale__: consigliato solo ai fini di test
            2. __monitoraggio tramite stream__: consigliato per ambienti di produzione

      #### 4.1 Monitoraggio puntuale

      Se la "richiesta di invio di notifica" passa le validazioni viene trasformata in "notifica" . Sarà possibile
      identificarla dallo IUN restituito dall'operazione
      [getNotificationRequestStatus](#/SenderReadB2B/retrieveNotificationRequestStatusV23).</br> 
      A questo punto, si potranno utilizzare l'operazione _GET /delivery/v2.4/notifications/sent/{iun}_ per
      ottenere i dettagli della notifica, la _timeline_ che dettaglia il perfezionamento della
      notifica per il mittente e l'avanzamento delle comunicazioni nei confronti dei destinatari.
      
      #### 4.2 Monitoraggio tramite stream

      Questa è la modalità consigliata in produzione. Per essere utilizzata è necessaria un'operazione preliminare
      tramite la chiamata alla API [createEventStream](#/Streams/createEventStream)
      per configurare uno "stream" che registri il cambio di stato della notifica con il seguente payload di esempio:</br></br>``
      {
        "title": "NotificationAccepted",
        "eventType": "STATUS"
      }
      ``</br></br>che permette di monitorare gli eventi di tipo "STATO". Successivamente si può ottenere il dettaglio della stream appena creata chiamando la 
      API [getEventStream](https://petstore.swagger.io/?url=https%3A%2F%2Fraw.githubusercontent.com%2Fpagopa%2Fpn-delivery-push%2Fdevelop%2Fdocs%2Fopenapi%2Fapi-external-b2b-webhook.yaml#/Streams/getEventStream), mentre si possono ottenere i dati degli eventi richiamando la API [consumeEventStream](https://petstore.swagger.io/?url=https%3A%2F%2Fraw.githubusercontent.com%2Fpagopa%2Fpn-delivery-push%2Fdevelop%2Fdocs%2Fopenapi%2Fapi-external-b2b-webhook.yaml#/Events/consumeEventStream)


      ``</br></br>che permette di monitorare gli eventi di tipo "STATO". Successivamente si può ottenere il dettaglio 
      dello stream appena creato chiamando la API [getEventStream](#/Streams/getEventStream)), mentre si possono 
      ottenere i dati degli eventi richiamando la API [consumeEventStream](#/Streams/consumeEventStream)


      __NOTA__ saranno disponibili i dati di cambiamento di stato occorsi solo successivamente alla configurazione
      dello stream.

      </br>

      ### 5. Download dei Legal Facts

      É possibile scaricare le Attestazioni Opponibili a Terzi e gli altri documenti conservati da Piattaforma Notifiche attraverso il servizio di [download Legal Fact](#/LegalFacts/downloadLegalFactById) passando all'interno del path lo <strong>Iun</strong>, il <strong>legalFactType</strong> ed il <strong>legalFactId</strong>; si otterrà nella response un link che permette di scaricare il documento richiesto.</br> Per ottenere il <strong>legalFactType</strong> ed il <strong>legalFactId</strong> bisogna chiamare il servizio di [lettura dettaglio notifica](#/SenderReadB2B/retrieveSentNotificationV21) con lo <code>{Iun}</code> della notifica di interesse: all'interno del campo <i>timeline</i> della response è possibile trovare l'elenco degli eventi di quella notifica ed i <strong>legalFactType</strong> e <strong>legalFactId</strong> in corrispondenza degli eventi che generano documenti.
      
    </br>

    <details>
      <summary><strong><big><big><big><big>AMBIENTI</big></big></big></big></strong></summary>
    <ul>   <li><strong>https://api.notifichedigitali.it:</strong></br>Ambiente
    di produzione</li>
    <li><strong>https://api.uat.notifichedigitali.it:</strong></br>Ambiente di
    collaudo. Potrebbe subire modifiche/integrazioni in futuro, rimanendo
    comunque non-bloccante e rispettando il principio di retro
    compatibilità</li> </ul>   </details></br>
  contact:
    name: 'SEND: supporto enti'
    url: https://pagopa.atlassian.net/servicedesk/customer/portal/5
servers:
  - url: https://api.notifichedigitali.it
    description: Ambiente di produzione
  - url: https://api.uat.notifichedigitali.it
    description: Ambiente di collaudo
tags:
  - name: HealthCheck
    description: >-
      Invocazioni per sapere lo stato di Piattaforma Notifiche # il servizio è
      ancora in fase di sviluppo
  - name: NewNotification
    description: >-
      Invocazioni per effettuare il pre-caricamento dei documenti della notifica
      e inviare notifiche
  - name: SenderReadB2B
    description: >-
      Invocazioni utilizzabili dai mittenti per verificare lo stato delle
      richieste  di notifica inviate e delle notifiche accettate.
  - name: NotificationPrice
    description: Invocazioni per determinare il costo della notifica per il destinatario.
  - name: LegalFacts
    description: Invocazioni per effettuare il download degli atti opponibili a terzi
  - name: PaymentEvents
    description: Invocazioni per comunicare eventi di pagamento dalla PA
  - name: NotificationCancellation
    description: Annullamento di una notifica
paths:
  /status:
    get:
      summary: status path
      description: status path per verificare lo stato di Piattaforma Notifiche
      tags:
        - HealthCheck
      operationId: status
      responses:
        '200':
          description: Ok
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/PnStatusResponse'
              example:
                functionalities:
                  - NOTIFICATION_CREATE
                  - NOTIFICATION_VISUALIZATION
                  - NOTIFICATION_WORKFLOW
                openIncidents: []
        '400':
          description: Bad request
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
        '500':
          description: Internal Server Error
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/PnStatusResponse'
              example:
                functionalities:
                  - NOTIFICATION_CREATE
                  - NOTIFICATION_VISUALIZATION
                  - NOTIFICATION_WORKFLOW
                openIncidents:
                  - functionality: NOTIFICATION_CREATE
                    status: KO
                    startDate: '2019-08-24T14:15:22Z'
  /delivery/attachments/preload:
    post:
      summary: Richiesta di pre-caricamento dei documenti della notifica
      description: >-
        Operazione che richiede a Piattaforma Notifica le informazioni e le
        autorizzazioni necessarie  a precaricare uno o più file da allegare a
        una notifica. <br/>
      tags:
        - NewNotification
      operationId: presignedUploadRequest
      requestBody:
        content:
          application/json:
            schema:
              type: array
              items:
                $ref: '#/components/schemas/PreLoadRequest'
              minItems: 1
              maxItems: 15
        required: true
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/PreLoadResponse'
        '400':
          description: Bad request
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
        '500':
          description: Internal error
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
  /delivery/v2.5/requests:
    post:
      summary: Richiesta invio notifica
      description: >-
        Operazione utilizzata dalla Pubblica Amministrazione per richiedere
        l'invio di una notifica.


        La restituzione di uno stato HTTP 202 significa solo che la richiesta è
        sintatticamente

        valida, non che la richiesta sia stata validata ed accettata. <br/>

        Per conoscere lo stato di accettazione della richiesta di notifica
        bisogna utilizzare l'operazione

        _getNotificationRequestStatus_ oppure utilizzare la modalità push
        prevista dai webhook. <br/>
      tags:
        - NewNotification
      operationId: sendNewNotificationV25
      requestBody:
        content:
          application/json:
            schema:
              $ref: >-
                ./schemas-pn-notification.yaml#/components/schemas/NewNotificationRequestV25
        required: true
      responses:
        '202':
          description: Accepted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NewNotificationResponse'
        '400':
          description: Bad request
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
        '409':
          description: Conflict
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
        '500':
          description: Internal error
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
    get:
      operationId: retrieveNotificationRequestStatusV25
      tags:
        - SenderReadB2B
      summary: Verifica accettazione richiesta notifica
      description: >-
        Questa operazione serve per verificare se la richiesta di notifica è
        stata accettata e ottenere lo IUN associato a tale richiesta. <br/>
        Bisogna specificare il parametro _requestId_ oppure la coppia costituita
        dai parametri  _paProtocolNumber_ e _idempotenceToken_. <br/>
      parameters:
        - $ref: '#/components/parameters/notificationRequestId'
        - $ref: '#/components/parameters/paProtocolNumber'
        - $ref: '#/components/parameters/idempotenceToken'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NewNotificationRequestStatusResponseV25'
        '400':
          description: Bad request
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
        '404':
          description: Not found
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
        '500':
          description: Internal error
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
  /delivery/v2.7/notifications/sent/{iun}:
    get:
      summary: 'Mittente: lettura dettagli notifica versione 2'
      description: >-
        Questa operazione permette di leggere tutti i dettagli di una notifica
        accettata. <br/>
      tags:
        - SenderReadB2B
      operationId: retrieveSentNotificationV27
      parameters:
        - $ref: ./parameters-notification-search.yaml#/components/parameters/pathIun
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FullSentNotificationV27'
        '400':
          description: Bad request
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
        '500':
          description: Internal error
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
  /delivery/notifications/sent/{iun}/attachments/documents/{docIdx}:
    get:
      description: Download documento notificato
      summary: Download documento notificato
      tags:
        - SenderReadB2B
      operationId: retrieveSentNotificationDocument
      parameters:
        - $ref: ./parameters-notification-search.yaml#/components/parameters/pathIun
        - $ref: '#/components/parameters/pathDocumentIdx'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: >-
                  ./schemas-pn-notification.yaml#/components/schemas/NotificationAttachmentDownloadMetadataResponse
        '400':
          description: Bad request
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
        '404':
          description: Not Found
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
        '500':
          description: Internal error
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
  /delivery/notifications/sent/{iun}/attachments/payment/{recipientIdx}/{attachmentName}:
    get:
      description: Download allegato per pagamento
      summary: Download allegato per pagamento
      tags:
        - SenderReadB2B
      operationId: retrieveSentNotificationAttachment
      parameters:
        - $ref: ./parameters-notification-search.yaml#/components/parameters/pathIun
        - $ref: '#/components/parameters/pathRecipientIdx'
        - $ref: '#/components/parameters/pathAttachmentName'
        - $ref: '#/components/parameters/attachmentIdx'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: >-
                  ./schemas-pn-notification.yaml#/components/schemas/NotificationAttachmentDownloadMetadataResponse
        '400':
          description: Bad request
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
        '404':
          description: Not Found
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
        '500':
          description: Internal error
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
  /delivery/v2.3/price/{paTaxId}/{noticeCode}:
    get:
      operationId: retrieveNotificationPriceV23
      summary: Retrieve notification partial price and total price with effective date
      description: >-
        Usata dagli enti per recuperare il costo di notificazione tramite
        l'identificativo della posizione debitoria paTaxId e noticeCode. Viene
        restituito sia il costo parziale che il costo totale di notificazione.
      tags:
        - NotificationPriceV23
      parameters:
        - name: paTaxId
          description: Payment PA fiscal code
          in: path
          required: true
          example: '77777777777'
          schema:
            $ref: schemas-pn-notification.yaml#/components/schemas/paTaxId
        - name: noticeCode
          description: Payment notice number  numero avviso
          in: path
          required: true
          example: '302000100000019421'
          schema:
            $ref: schemas-pn-notification.yaml#/components/schemas/noticeCode
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotificationPriceResponseV23'
        '400':
          description: Invalid input
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
        '404':
          description: Not Found
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
        '500':
          description: Internal Server Error
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
  /delivery/events/payment/pagopa:
    post:
      operationId: paymentEventsRequestPagoPa
      description: >-
        Questa API è a disposizione della Pubblica Amministrazione per inviare
        eventi di chiusura di una o più posizioni debitorie di tipo PagoPA.
        <br/>
      tags:
        - PaymentEvents
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PaymentEventsRequestPagoPa'
      responses:
        '204':
          description: OK
        '400':
          description: Invalid input
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
        '404':
          description: Not found
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
        '500':
          description: Internal Server Error
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
  /delivery/events/payment/f24:
    post:
      deprecated: true
      operationId: paymentEventsRequestF24
      description: >-
        Questa API è a disposizione della Pubblica Amministrazione per inviare
        eventi di chiusura di una o più posizioni debitorie di tipo F24. <br/>
      tags:
        - PaymentEvents
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PaymentEventsRequestF24'
      responses:
        '204':
          description: OK
        '400':
          description: Invalid input
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
        '404':
          description: Not found
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
        '500':
          description: Internal Server Error
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
  /delivery/requests:
    post:
      deprecated: true
      summary: Richiesta invio notifica
      description: >-
        Operazione utilizzata dalla Pubblica Amministrazione per richiedere
        l'invio di una notifica.


        La restituzione di uno stato HTTP 202 significa solo che la richiesta è
        sintatticamente

        valida, non che la richiesta sia stata validata ed accettata. <br/>

        Per conoscere lo stato di accettazione della richiesta di notifica
        bisogna utilizzare l'operazione

        _getNotificationRequestStatus_ oppure utilizzare la modalità push
        prevista dai webhook. <br/>
      tags:
        - NewNotification
      operationId: sendNewNotification
      x-pagopa-lambda-name: pn-delivery-versioning-v1v21-sendnewnotification-lambda:live
      x-pagopa-lambda-account: core
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/NewNotificationRequest'
        required: true
      responses:
        '202':
          description: Accepted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NewNotificationResponse'
        '400':
          description: Bad request
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
        '409':
          description: Conflict
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
        '500':
          description: Internal error
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
    get:
      deprecated: true
      operationId: retrieveNotificationRequestStatus
      x-pagopa-lambda-name: pn-delivery-versioning-v1v21-getnotificationrequeststatus-lambda:live
      x-pagopa-lambda-account: core
      tags:
        - SenderReadB2B
      summary: Verifica accettazione richiesta notifica
      description: >-
        Questa operazione serve per verificare se la richiesta di notifica è
        stata accettata e ottenere lo IUN associato a tale richiesta. <br/>
        Bisogna specificare il parametro _requestId_ oppure la coppia costituita
        dai parametri  _paProtocolNumber_ e _idempotenceToken_. <br/>
      parameters:
        - $ref: '#/components/parameters/notificationRequestId'
        - $ref: '#/components/parameters/paProtocolNumber'
        - $ref: '#/components/parameters/idempotenceToken'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NewNotificationRequestStatusResponse'
        '400':
          description: Bad request
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
        '404':
          description: Not found
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
        '500':
          description: Internal error
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
  /delivery/v2.1/requests:
    post:
      deprecated: true
      summary: Richiesta invio notifica
      description: >-
        Operazione utilizzata dalla Pubblica Amministrazione per richiedere
        l'invio di una notifica.


        La restituzione di uno stato HTTP 202 significa solo che la richiesta è
        sintatticamente

        valida, non che la richiesta sia stata validata ed accettata. <br/>

        Per conoscere lo stato di accettazione della richiesta di notifica
        bisogna utilizzare l'operazione

        _getNotificationRequestStatus_ oppure utilizzare la modalità push
        prevista dai webhook. <br/>
      tags:
        - NewNotification
      operationId: sendNewNotificationV21
      x-pagopa-lambda-name: pn-delivery-versioning-v1v21-sendnewnotification-lambda:live
      x-pagopa-lambda-account: core
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/NewNotificationRequestV21'
        required: true
      responses:
        '202':
          description: Accepted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NewNotificationResponse'
        '400':
          description: Bad request
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
        '409':
          description: Conflict
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
        '500':
          description: Internal error
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
    get:
      deprecated: true
      operationId: retrieveNotificationRequestStatusV21
      x-pagopa-lambda-name: pn-delivery-versioning-v1v21-getnotificationrequeststatus-lambda:live
      x-pagopa-lambda-account: core
      tags:
        - SenderReadB2B
      summary: Verifica accettazione richiesta notifica
      description: >-
        Questa operazione serve per verificare se la richiesta di notifica è
        stata accettata e ottenere lo IUN associato a tale richiesta. <br/>
        Bisogna specificare il parametro _requestId_ oppure la coppia costituita
        dai parametri  _paProtocolNumber_ e _idempotenceToken_. <br/>
      parameters:
        - $ref: '#/components/parameters/notificationRequestId'
        - $ref: '#/components/parameters/paProtocolNumber'
        - $ref: '#/components/parameters/idempotenceToken'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NewNotificationRequestStatusResponseV21'
        '400':
          description: Bad request
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
        '404':
          description: Not found
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
        '500':
          description: Internal error
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
  /delivery/v2.3/requests:
    post:
      deprecated: true
      summary: Richiesta invio notifica
      description: >-
        Operazione utilizzata dalla Pubblica Amministrazione per richiedere
        l'invio di una notifica.


        La restituzione di uno stato HTTP 202 significa solo che la richiesta è
        sintatticamente

        valida, non che la richiesta sia stata validata ed accettata. <br/>

        Per conoscere lo stato di accettazione della richiesta di notifica
        bisogna utilizzare l'operazione

        _getNotificationRequestStatus_ oppure utilizzare la modalità push
        prevista dai webhook. <br/>
      tags:
        - NewNotification
      operationId: sendNewNotificationV23
      x-pagopa-lambda-name: pn-delivery-versioning-v1v21-sendnewnotification-lambda:live
      x-pagopa-lambda-account: core
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/NewNotificationRequestV23'
        required: true
      responses:
        '202':
          description: Accepted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NewNotificationResponse'
        '400':
          description: Bad request
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
        '409':
          description: Conflict
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
        '500':
          description: Internal error
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
    get:
      deprecated: true
      operationId: retrieveNotificationRequestStatusV23
      x-pagopa-lambda-name: pn-delivery-versioning-v1v21-getnotificationrequeststatus-lambda:live
      x-pagopa-lambda-account: core
      tags:
        - SenderReadB2B
      summary: Verifica accettazione richiesta notifica
      description: >-
        Questa operazione serve per verificare se la richiesta di notifica è
        stata accettata e ottenere lo IUN associato a tale richiesta. <br/>
        Bisogna specificare il parametro _requestId_ oppure la coppia costituita
        dai parametri  _paProtocolNumber_ e _idempotenceToken_. <br/>
      parameters:
        - $ref: '#/components/parameters/notificationRequestId'
        - $ref: '#/components/parameters/paProtocolNumber'
        - $ref: '#/components/parameters/idempotenceToken'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NewNotificationRequestStatusResponseV23'
        '400':
          description: Bad request
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
        '404':
          description: Not found
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
        '500':
          description: Internal error
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
  /delivery/v2.4/requests:
    post:
      deprecated: true
      summary: Richiesta invio notifica
      description: >-
        Operazione utilizzata dalla Pubblica Amministrazione per richiedere
        l'invio di una notifica.


        La restituzione di uno stato HTTP 202 significa solo che la richiesta è
        sintatticamente

        valida, non che la richiesta sia stata validata ed accettata. <br/>

        Per conoscere lo stato di accettazione della richiesta di notifica
        bisogna utilizzare l'operazione

        _getNotificationRequestStatus_ oppure utilizzare la modalità push
        prevista dai webhook. <br/>
      tags:
        - NewNotification
      operationId: sendNewNotificationV24
      x-pagopa-lambda-name: pn-delivery-versioning-v1v21-sendnewnotification-lambda:live
      x-pagopa-lambda-account: core
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/NewNotificationRequestV24'
        required: true
      responses:
        '202':
          description: Accepted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NewNotificationResponse'
        '400':
          description: Bad request
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
        '409':
          description: Conflict
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
        '500':
          description: Internal error
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
    get:
      deprecated: true
      operationId: retrieveNotificationRequestStatusV24
      x-pagopa-lambda-name: pn-delivery-versioning-v1v21-getnotificationrequeststatus-lambda:live
      x-pagopa-lambda-account: core
      tags:
        - SenderReadB2B
      summary: Verifica accettazione richiesta notifica
      description: >-
        Questa operazione serve per verificare se la richiesta di notifica è
        stata accettata e ottenere lo IUN associato a tale richiesta. <br/>
        Bisogna specificare il parametro _requestId_ oppure la coppia costituita
        dai parametri  _paProtocolNumber_ e _idempotenceToken_. <br/>
      parameters:
        - $ref: '#/components/parameters/notificationRequestId'
        - $ref: '#/components/parameters/paProtocolNumber'
        - $ref: '#/components/parameters/idempotenceToken'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NewNotificationRequestStatusResponseV24'
        '400':
          description: Bad request
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
        '404':
          description: Not found
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
        '500':
          description: Internal error
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
  /delivery/notifications/sent/{iun}:
    get:
      deprecated: true
      summary: 'Mittente: lettura dettagli notifica'
      description: >-
        Questa operazione permette di leggere tutti i dettagli di una notifica
        accettata. <br/>
      tags:
        - SenderReadB2B
      operationId: retrieveSentNotification
      x-pagopa-lambda-name: pn-delivery-versioning-v1v2-getnotification-lambda:live
      x-pagopa-lambda-account: core
      parameters:
        - $ref: ./parameters-notification-search.yaml#/components/parameters/pathIun
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FullSentNotification'
        '400':
          description: Bad request
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
        '500':
          description: Internal error
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
  /delivery/v2.0/notifications/sent/{iun}:
    get:
      deprecated: true
      summary: 'Mittente: lettura dettagli notifica versione 2'
      description: >-
        Questa operazione permette di leggere tutti i dettagli di una notifica
        accettata. <br/>
      tags:
        - SenderReadB2B
      operationId: retrieveSentNotificationV20
      x-pagopa-lambda-name: pn-delivery-versioning-v1v2-getnotification-lambda:live
      x-pagopa-lambda-account: core
      parameters:
        - $ref: ./parameters-notification-search.yaml#/components/parameters/pathIun
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FullSentNotificationV20'
        '400':
          description: Bad request
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
        '500':
          description: Internal error
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
  /delivery/v2.1/notifications/sent/{iun}:
    get:
      deprecated: true
      summary: 'Mittente: lettura dettagli notifica versione 2'
      description: >-
        Questa operazione permette di leggere tutti i dettagli di una notifica
        accettata. <br/>
      tags:
        - SenderReadB2B
      operationId: retrieveSentNotificationV21
      x-pagopa-lambda-name: pn-delivery-versioning-v1v2-getnotification-lambda:live
      x-pagopa-lambda-account: core
      parameters:
        - $ref: ./parameters-notification-search.yaml#/components/parameters/pathIun
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FullSentNotificationV21'
        '400':
          description: Bad request
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
        '500':
          description: Internal error
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
  /delivery/v2.3/notifications/sent/{iun}:
    get:
      deprecated: true
      summary: 'Mittente: lettura dettagli notifica versione 2'
      description: >-
        Questa operazione permette di leggere tutti i dettagli di una notifica
        accettata. <br/>
      tags:
        - SenderReadB2B
      operationId: retrieveSentNotificationV23
      x-pagopa-lambda-name: pn-delivery-versioning-v1v2-getnotification-lambda:live
      x-pagopa-lambda-account: core
      parameters:
        - $ref: ./parameters-notification-search.yaml#/components/parameters/pathIun
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FullSentNotificationV23'
        '400':
          description: Bad request
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
        '500':
          description: Internal error
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
  /delivery/v2.4/notifications/sent/{iun}:
    get:
      deprecated: true
      summary: 'Mittente: lettura dettagli notifica versione 2'
      description: >-
        Questa operazione permette di leggere tutti i dettagli di una notifica
        accettata. <br/>
      tags:
        - SenderReadB2B
      operationId: retrieveSentNotificationV24
      x-pagopa-lambda-name: pn-delivery-versioning-v1v2-getnotification-lambda:live
      x-pagopa-lambda-account: core
      parameters:
        - $ref: ./parameters-notification-search.yaml#/components/parameters/pathIun
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FullSentNotificationV24'
        '400':
          description: Bad request
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
        '500':
          description: Internal error
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
  /delivery/v2.5/notifications/sent/{iun}:
    get:
      deprecated: true
      summary: 'Mittente: lettura dettagli notifica versione 2'
      description: >-
        Questa operazione permette di leggere tutti i dettagli di una notifica
        accettata. <br/>
      tags:
        - SenderReadB2B
      operationId: retrieveSentNotificationV25
      x-pagopa-lambda-name: pn-delivery-versioning-v1v2-getnotification-lambda:live
      x-pagopa-lambda-account: core
      parameters:
        - $ref: ./parameters-notification-search.yaml#/components/parameters/pathIun
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FullSentNotificationV25'
        '400':
          description: Bad request
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
        '500':
          description: Internal error
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
  /delivery/v2.6/notifications/sent/{iun}:
    get:
      deprecated: true
      summary: 'Mittente: lettura dettagli notifica versione 2'
      description: >-
        Questa operazione permette di leggere tutti i dettagli di una notifica
        accettata. <br/>
      tags:
        - SenderReadB2B
      operationId: retrieveSentNotificationV26
      x-pagopa-lambda-name: pn-delivery-versioning-v1v2-getnotification-lambda:live
      x-pagopa-lambda-account: core
      parameters:
        - $ref: ./parameters-notification-search.yaml#/components/parameters/pathIun
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FullSentNotificationV26'
        '400':
          description: Bad request
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
        '500':
          description: Internal error
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
  /delivery/price/{paTaxId}/{noticeCode}:
    get:
      deprecated: true
      operationId: retrieveNotificationPrice
      x-pagopa-lambda-name: pn-delivery-versioning-v1v23-getnotificationprice-lambda:live
      x-pagopa-lambda-account: core
      summary: Retrieve notification price and effective date
      description: |-
        Usata dalla PA per recuperare il costo di notificazione tramite
         l'identificativo della posizione debitoria paTaxId e noticeCode.
      tags:
        - NotificationPrice
      parameters:
        - name: paTaxId
          description: Payment PA fiscal code
          in: path
          required: true
          example: '77777777777'
          schema:
            $ref: schemas-pn-notification.yaml#/components/schemas/paTaxId
        - name: noticeCode
          description: Payment notice number  numero avviso
          in: path
          required: true
          example: '302000100000019421'
          schema:
            $ref: schemas-pn-notification.yaml#/components/schemas/noticeCode
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotificationPriceResponse'
        '400':
          description: Invalid input
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
        '404':
          description: Not Found
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
        '500':
          description: Internal Server Error
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/Problem'
components:
  parameters:
    notificationRequestId:
      in: query
      required: false
      name: notificationRequestId
      description: identificativo della richiesta di notifica
      schema:
        type: string
        maxLength: 36
        pattern: ^[A-Za-z0-9+/=]{36}$
    paProtocolNumber:
      name: paProtocolNumber
      in: query
      required: false
      description: >-
        Numero di protocollo associato alla notifica, può essere riutilizzato
        per rettifiche.
      schema:
        type: string
        pattern: ^.*$
        maxLength: 256
    idempotenceToken:
      name: idempotenceToken
      description: >-
        token usato per disambiguare "richieste di notificazione" effettuate con
        lo stesso  numero di protocollo.
      in: query
      required: false
      schema:
        type: string
        pattern: ^[ -~]*$
        maxLength: 256
    pathDocumentIdx:
      name: docIdx
      description: indice del documento nella lista partendo da 0.
      in: path
      required: true
      schema:
        type: integer
        format: int32
    pathRecipientIdx:
      name: recipientIdx
      description: indice del destinatario nella lista partendo da 0.
      in: path
      required: true
      schema:
        type: integer
        format: int32
    pathAttachmentName:
      name: attachmentName
      description: >-
        Tipologia del pagamento allegato alla notifica. Valori possibili
        PAGOPA|F24
      in: path
      required: true
      schema:
        type: string
        minLength: 3
        maxLength: 6
        pattern: PAGOPA|F24
    attachmentIdx:
      in: query
      name: attachmentIdx
      description: indice del documento di pagamento partendo da 0
      required: false
      schema:
        type: integer
        format: int32
  schemas:
    PnStatusResponse:
      $ref: ./remote-refs.yaml#/components/schemas/PnStatusResponse
    PreLoadRequest:
      title: Richiesta di precaricamento di un File
      type: object
      required:
        - sha256
      properties:
        preloadIdx:
          title: Id della richiesta di precaricamento di un file
          description: >-
            Identificativo univoco all'interno della request HTTP, serve per
            correlare la risposta. Stringa alfanumerica con caratteri
            utilizzabili in un nome file.
          type: string
          minLength: 1
          maxLength: 512
          pattern: ^[a-zA-Z0-9._-]{1,512}$
        contentType:
          title: MIME type del file che verrà caricato
          description: >-
            Il MIME type dell'allegato che dovrà essere caricato. Attualmente
            sono supportati
              - application/pdf
              - application/json
          type: string
          minLength: 15
          maxLength: 16
          pattern: ^application\/(pdf|json)$
        sha256:
          title: checksum sha256 del file che verrà caricato
          description: >-
            checksum sha256, codificato in base 64, del contenuto binario del
            file che verrà caricato
          type: string
          example: jezIVxlG1M1woCSUngM6KipUN3/p8cG5RMIPnuEanlE=
          minLength: 44
          maxLength: 44
          pattern: ^[A-Za-z0-9+\/]{43}=|[A-Za-z0-9+\/]{44}$
    PreLoadResponse:
      title: Informazioni per il caricamento file
      description: >-
        Per ogni richiesta che è stata fatta viene fornito un presigned URL e
        le  informazioni per usarlo.
      type: object
      properties:
        preloadIdx:
          description: >-
            per correlazione con la richiesta. Stringa alfanumerica con
            caratteri utilizzabili in un file.
          type: string
          minLength: 1
          maxLength: 512
          pattern: ^[a-zA-Z0-9._-]{1,512}$
        secret:
          description: >-
            Token aggiuntivo per far si che sia necessario intercettare anche
            gli  header e non solo l'URL di upload del contenuto del documento.
          example: AZ23RF12
          type: string
        httpMethod:
          description: >-
            Indica se per l'upload del contenuto file bisogna utilizzare il
            metodo PUT o POST
          type: string
          example: PUT
          enum:
            - POST
            - PUT
        url:
          description: URL a cui effettuare l'upload del contenuto del documento.
          type: string
          example: https://preloadpn.aws.amazon.......
        key:
          description: >-
            la chiave restituita sarà globalmente unica e andrà utilizzata nella
            richiesta  di notifica.
          example: PN_NOTIFICATION_ATTACHMENTS-0001-301W-B9CB-9U72-WIKD
          type: string
    NotificationPriceResponse:
      title: Notification price Response
      description: Notification price and effective date
      type: object
      properties:
        iun:
          $ref: ./schemas-pn-notification.yaml#/components/schemas/IUN
        amount:
          description: amount in euro cents
          type: integer
          format: int32
        refinementDate:
          description: >-
            data di perfezionamento per decorrenza termini localizzata espressa
            alla mezzanotte del giorno in cui si verifica l'evento
          type: string
          format: date-time
        notificationViewDate:
          description: >-
            data di perfezionamento per presa visione espressa alla mezzanotte
            del giorno in cui si verifica l'evento
          type: string
          format: date-time
    NotificationPriceResponseV23:
      title: Notification price Response
      description: Notification price and effective date
      type: object
      properties:
        iun:
          $ref: ./schemas-pn-notification.yaml#/components/schemas/IUN
        partialPrice:
          description: Costo totale di notificazione che non include la paFee e vat
          type: integer
          format: int32
        totalPrice:
          description: >-
            Costo totale di notificazione che include la paFee e vat applicato
            ai costi cartacei. Se vat e paFee non sono valorizzati, verranno
            usati i loro valori di default (vedi /components/schemas/VatV23 e
            /components/schemas/PaFeeV23).
          type: integer
          format: int32
        vat:
          $ref: schemas-pn-notification.yaml#/components/schemas/VatV23
        paFee:
          $ref: schemas-pn-notification.yaml#/components/schemas/PaFeeV23
        refinementDate:
          description: >-
            data di perfezionamento per decorrenza termini localizzata espressa
            alla mezzanotte del giorno in cui si verifica l'evento
          type: string
          format: date-time
        notificationViewDate:
          description: >-
            data di perfezionamento per presa visione espressa alla mezzanotte
            del giorno in cui si verifica l'evento
          type: string
          format: date-time
        sendFee:
          description: costo base di SeND per notificazione
          type: integer
          format: int32
        analogCost:
          description: costo totale dei prodotti postali
          type: integer
          format: int32
    NewNotificationResponse:
      title: Identificativi della richiesta di notifica
      description: >-
        Contiene le informazioni per identificare una richiesta di invio
        notifica che non è ancora stata accettata da Piattaforma notifiche.
      type: object
      required:
        - notificationRequestId
        - paProtocolNumber
      properties:
        notificationRequestId:
          type: string
          description: >-
            identificativo univoco di una richiesta di invio notifica, non è lo
            IUN
          maxLength: 36
          pattern: ^[A-Za-z0-9+/=]{36}$
        paProtocolNumber:
          type: string
          description: Identificativo inviato dalla pubblica amministrazione
        idempotenceToken:
          description: >-
            Ripetizione del token usato per disambiguare "richieste di
            notificazione"  effettuate con lo stesso numero di protocollo (campo
            _paProtocolNumber_).
          type: string
    NewNotificationRequestStatusResponseV25:
      allOf:
        - $ref: >-
            ./schemas-pn-notification.yaml#/components/schemas/NewNotificationRequestV25
        - type: object
          required:
            - notificationRequestId
            - notificationRequestStatus
          properties:
            notificationRequestId:
              description: >-
                identificativo univoco di una richiesta di invio notifica, non è
                lo IUN
              type: string
            notificationRequestStatus:
              description: >-
                - __WAITING__: in attesa di essere valutata - __ACCEPTED__:
                richiesta di notifica accettata, lo IUN è valorizzato -
                __REFUSED__: richiesta di notifica rifiutata, è valorizzato il
                campo _errors_
              type: string
            retryAfter:
              type: integer
              format: int32
              description: >-
                Numero di secondi da attendere prima di effettuare una nuova
                richiesta per  la stessa entità; valorizzato quando lo status è
                __WAITING__.
            iun:
              $ref: ./schemas-pn-notification.yaml#/components/schemas/IUN
            errors:
              description: >-
                Elenco degli errori che hanno causato il rifiuto della richiesta
                di notifica
              type: array
              items:
                $ref: '#/components/schemas/ProblemError'
    Problem:
      $ref: ./remote-refs.yaml#/components/schemas/Problem
    ProblemError:
      $ref: ./remote-refs.yaml#/components/schemas/ProblemError
    FullSentNotificationV27:
      description: >-
        Le informazioni riguardanti una notifica (richiesta di notifica
        accettata) e il  processo di inoltro della notifica verso il cittadino.
      allOf:
        - $ref: >-
            ./schemas-pn-notification.yaml#/components/schemas/SentNotificationV25
        - type: object
          required:
            - notificationStatus
            - notificationStatusHistory
            - timeline
          properties:
            notificationStatus:
              $ref: '#/components/schemas/NotificationStatusV26'
            notificationStatusHistory:
              $ref: '#/components/schemas/NotificationStatusHistoryV26'
            timeline:
              description: >-
                elenco dettagliato di tutto ciò che è accaduto durrante il
                processo di notifica
              type: array
              items:
                $ref: '#/components/schemas/TimelineElementV26'
    PaymentEventsRequestPagoPa:
      title: Invio eventi di pagamento da PA a PN
      description: >-
        Richiesta contenente un array di eventi di pagamento di tipo PagoPA di
        cui una Pubblica Amministrazione deve avvisare Piattaforma Notifiche.
      type: object
      required:
        - events
      properties:
        events:
          description: Elenco degli eventi di pagamento
          type: array
          items:
            $ref: '#/components/schemas/PaymentEventPagoPa'
    PaymentEventsRequestF24:
      title: Invio eventi di pagamento da PA a PN
      description: >-
        Richiesta contenente un array di eventi di pagamento di tipo F24 di cui
        una Pubblica Amministrazione deve avvisare Piattaforma Notifiche.
      type: object
      required:
        - events
      properties:
        events:
          description: Elenco degli eventi di pagamento
          type: array
          items:
            $ref: '#/components/schemas/PaymentEventF24'
    PaymentEventPagoPa:
      title: Evento di pagamento PagoPa
      description: |-
        Comprende: <br/>
          - _noticeCode_: "codice avviso pagoPA" di pagamento del sistema pagoPA, usato per pagamento online.<br/>
          - _creditorTaxId_: codice fiscale dell'ente a cui fa riferimento il "codice avviso pagoPA". <br/>
          - data e ora del pagamento. <br/>
          - importo del pagamento in eurocent. <br/>
      type: object
      required:
        - noticeCode
        - creditorTaxId
        - paymentDate
        - amount
      properties:
        noticeCode:
          $ref: schemas-pn-notification.yaml#/components/schemas/noticeCode
        creditorTaxId:
          $ref: schemas-pn-notification.yaml#/components/schemas/paTaxId
        paymentDate:
          type: string
          pattern: >-
            ^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(\.[0-9]+)?(Z|([+\-][0-9]{2}):([0-9]{2}))$
          description: data e ora in formato ISO 8601
        amount:
          type: integer
          format: int32
    PaymentEventF24:
      title: Evento di pagamento F24
      description: |-
        Comprende: <br/>
          - lo _IUN_ della notifica pagata, <br/>
          - data e ora del pagamento, <br/>
          - il codice fiscale del destinatario pagatore, <br/>
          - la tipologia del destinatario pagatore (PF / PG), <br/>
          - importo del pagamento in eurocent. <br/>
      type: object
      required:
        - iun
        - paymentDate
        - recipientTaxId
        - recipientType
        - amount
      properties:
        iun:
          type: string
          minLength: 25
          maxLength: 25
          pattern: ^[A-Z]{4}-[A-Z]{4}-[A-Z]{4}-[0-9]{6}-[A-Z]{1}-[0-9]{1}$
        paymentDate:
          type: string
          format: date-time
        recipientTaxId:
          $ref: schemas-pn-notification.yaml#/components/schemas/TaxId
        recipientType:
          type: string
          minLength: 2
          maxLength: 2
          pattern: PF|PG
        amount:
          type: integer
          format: int32
    TimelineElementV26:
      $ref: ./remote-refs.yaml#/components/schemas/TimelineElementV26
    NotificationStatusV26:
      $ref: ./remote-refs.yaml#/components/schemas/NotificationStatusV26
    NotificationStatusHistoryV26:
      $ref: ./remote-refs.yaml#/components/schemas/NotificationStatusHistoryV26
    F24Metadata:
      $ref: ./remote-refs.yaml#/components/schemas/F24Metadata
    RequestStatus:
      $ref: ./remote-refs.yaml#/components/schemas/RequestStatus
    NewNotificationRequest:
      description: I campi utilizzati per la creazione di una nuova Notifica.
      type: object
      required:
        - paProtocolNumber
        - subject
        - recipients
        - documents
        - physicalCommunicationType
        - notificationFeePolicy
        - senderDenomination
        - senderTaxId
        - taxonomyCode
      properties:
        idempotenceToken:
          description: >-
            Identificativo utilizzabile dal chiamante per disambiguare
            differenti  "richieste di notificazione" effettuate con lo stesso
            numero di protocollo  (campo _paProtocolNumber_). Questo può essere
            necessario in caso di  "richiesta di notifica" rifiutata per errori
            nei codici di verifica degli allegati.
          type: string
          pattern: ^[ -~]*$
          maxLength: 256
        paProtocolNumber:
          description: Numero di protocollo che la PA mittente assegna alla notifica stessa
          type: string
          pattern: ^.*$
          maxLength: 256
        subject:
          type: string
          description: titolo della notifica, NON inserire dati personali/sensibili
          minLength: 10
          maxLength: 134
          pattern: ^.*$
        abstract:
          type: string
          description: >-
            descrizione sintetica della notifica, NON inserire dati
            personali/sensibili
          pattern: ^.*$
          maxLength: 1024
        recipients:
          type: array
          description: Informazioni sui destinatari
          items:
            $ref: '#/components/schemas/NotificationRecipient'
        documents:
          type: array
          description: Documenti notificati
          items:
            $ref: >-
              ./schemas-pn-notification.yaml#/components/schemas/NotificationDocument
          minItems: 1
        notificationFeePolicy:
          $ref: >-
            ./schemas-pn-notification.yaml#/components/schemas/NotificationFeePolicy
        cancelledIun:
          $ref: ./schemas-pn-notification.yaml#/components/schemas/IUN
        physicalCommunicationType:
          type: string
          description: Tipologia comunicazione fisica
          enum:
            - AR_REGISTERED_LETTER
            - REGISTERED_LETTER_890
        senderDenomination:
          $ref: ./schemas-pn-notification.yaml#/components/schemas/Denomination
        senderTaxId:
          $ref: ./schemas-pn-notification.yaml#/components/schemas/paTaxId
        group:
          type: string
          description: Gruppo di utenti dell'ente mittente che può visualizzare la notifica
          pattern: ^[ -~]*$
          maxLength: 1024
        amount:
          type: integer
          format: int32
          description: Importo della notifica in eurocent
        paymentExpirationDate:
          type: string
          minLength: 10
          maxLength: 10
          pattern: ^([0-9]{4})-(1[0-2]|0[1-9])-(3[01]|[12][0-9]|0[1-9])$
          description: >-
            Data di scadenza del pagamento nel formato YYYY-MM-DD riferito
            all'Italia
        taxonomyCode:
          type: string
          minLength: 7
          maxLength: 7
          pattern: ^([0-9]{6}[A-Z]{1})$
          description: >-
            Codice tassonomico della notifica basato sulla definizione presente
            nell'allegato 2 capitolo C del bando [__AVVISO PUBBLICO MISURA 1.4.5
            PIATTAFORMA NOTIFICHE
            DIGITALI__](https://pnrrcomuni.fondazioneifel.it/bandi_public/Bando/325)      
        pagoPaIntMode:
          type: string
          description: >-
            Modalitá di integrazione pagoPA per l'attualizazione del costo della
            notifica. <br/> - _NONE_: nessuna attualizzazione. <br/> - _SYNC_:
            modalitá sincrona. <br/> - _ASYNC_: modalitá asincrona. (Non ancora
            supportata) <br/>
          enum:
            - NONE
            - SYNC
            - ASYNC
    SentNotification:
      description: Le informazioni riguardanti una richiesta di notifica accettata
      allOf:
        - $ref: '#/components/schemas/NewNotificationRequest'
        - type: object
          required:
            - iun
            - sentAt
          properties:
            senderPaId:
              type: string
              description: >-
                Identificativo (non IPA) della PA mittente che ha eseguito
                l'onboarding su SelfCare.
              pattern: ^.*$
              maxLength: 256
            iun:
              $ref: ./schemas-pn-notification.yaml#/components/schemas/IUN
            sentAt:
              type: string
              description: Momento di ricezione della notifica da parte di PN
              format: date-time
            cancelledByIun:
              $ref: ./schemas-pn-notification.yaml#/components/schemas/IUN
            documentsAvailable:
              type: boolean
              description: Indica se i documenti notificati sono ancora disponibili.
    NewNotificationRequestV21:
      description: I campi utilizzati per la creazione di una nuova Notifica.
      type: object
      required:
        - paProtocolNumber
        - subject
        - recipients
        - documents
        - physicalCommunicationType
        - notificationFeePolicy
        - senderDenomination
        - senderTaxId
        - taxonomyCode
      properties:
        idempotenceToken:
          description: >-
            Identificativo utilizzabile dal chiamante per disambiguare
            differenti  "richieste di notificazione" effettuate con lo stesso
            numero di protocollo  (campo _paProtocolNumber_). Questo può essere
            necessario in caso di  "richiesta di notifica" rifiutata per errori
            nei codici di verifica degli allegati.
          type: string
          pattern: ^[ -~]*$
          maxLength: 256
        paProtocolNumber:
          description: Numero di protocollo che la PA mittente assegna alla notifica stessa
          type: string
          pattern: ^.*$
          maxLength: 256
        subject:
          type: string
          description: titolo della notifica
          maxLength: 134
          pattern: ^.*$
        abstract:
          type: string
          description: descrizione sintetica della notifica
          pattern: ^.*$
          maxLength: 1024
        recipients:
          type: array
          description: Informazioni sui destinatari
          items:
            $ref: '#/components/schemas/NotificationRecipientV21'
        documents:
          type: array
          description: Documenti notificati
          items:
            $ref: >-
              ./schemas-pn-notification.yaml#/components/schemas/NotificationDocument
          minItems: 1
        notificationFeePolicy:
          $ref: >-
            ./schemas-pn-notification.yaml#/components/schemas/NotificationFeePolicy
        cancelledIun:
          $ref: ./schemas-pn-notification.yaml#/components/schemas/IUN
        physicalCommunicationType:
          type: string
          description: Tipologia comunicazione fisica
          enum:
            - AR_REGISTERED_LETTER
            - REGISTERED_LETTER_890
        senderDenomination:
          $ref: ./schemas-pn-notification.yaml#/components/schemas/Denomination
        senderTaxId:
          $ref: ./schemas-pn-notification.yaml#/components/schemas/paTaxId
        group:
          type: string
          description: Gruppo di utenti dell'ente mittente che può visualizzare la notifica
          pattern: ^[ -~]*$
          maxLength: 1024
        amount:
          type: integer
          format: int32
          description: Importo della notifica in eurocent
        paymentExpirationDate:
          type: string
          minLength: 10
          maxLength: 10
          pattern: ^([0-9]{4})-(1[0-2]|0[1-9])-(3[01]|[12][0-9]|0[1-9])$
          description: >-
            Data di scadenza del pagamento nel formato YYYY-MM-DD riferito
            all'Italia
        taxonomyCode:
          type: string
          minLength: 7
          maxLength: 7
          pattern: ^([0-9]{6}[A-Z]{1})$
          description: >-
            Codice tassonomico della notifica basato sulla definizione presente
            nell'allegato 2 capitolo C del bando [__AVVISO PUBBLICO MISURA 1.4.5
            PIATTAFORMA NOTIFICHE
            DIGITALI__](https://pnrrcomuni.fondazioneifel.it/bandi_public/Bando/325)
        paFee:
          $ref: '#/components/schemas/PaFeeV21'
        vat:
          $ref: '#/components/schemas/VatV21'
        pagoPaIntMode:
          type: string
          description: >-
            Modalitá di integrazione pagoPA per l'attualizazione del costo della
            notifica. <br/> - _NONE_: nessuna attualizzazione. <br/> - _SYNC_:
            modalitá sincrona. <br/> - _ASYNC_: modalitá asincrona. (non ancora
            supportata)<br/>
          enum:
            - NONE
            - SYNC
            - ASYNC
    NewNotificationRequestV23:
      description: I campi utilizzati per la creazione di una nuova Notifica.
      type: object
      required:
        - paProtocolNumber
        - subject
        - recipients
        - documents
        - physicalCommunicationType
        - notificationFeePolicy
        - senderDenomination
        - senderTaxId
        - taxonomyCode
      properties:
        idempotenceToken:
          description: >-
            Identificativo utilizzabile dal chiamante per disambiguare
            differenti  "richieste di notificazione" effettuate con lo stesso
            numero di protocollo  (campo _paProtocolNumber_). Questo può essere
            necessario in caso di  "richiesta di notifica" rifiutata per errori
            nei codici di verifica degli allegati.
          type: string
          pattern: ^[ -~]*$
          maxLength: 256
        paProtocolNumber:
          description: Numero di protocollo che la PA mittente assegna alla notifica stessa
          type: string
          pattern: ^.*$
          maxLength: 256
        subject:
          type: string
          description: titolo della notifica
          maxLength: 134
          pattern: ^.*$
        abstract:
          type: string
          description: descrizione sintetica della notifica
          pattern: ^.*$
          maxLength: 1024
        recipients:
          type: array
          description: Informazioni sui destinatari
          items:
            $ref: >-
              ./schemas-pn-notification-older-version.yaml#/components/schemas/NotificationRecipientV23
          minItems: 1
        documents:
          type: array
          description: Documenti notificati
          items:
            $ref: >-
              ./schemas-pn-notification.yaml#/components/schemas/NotificationDocument
          minItems: 1
        notificationFeePolicy:
          $ref: >-
            ./schemas-pn-notification.yaml#/components/schemas/NotificationFeePolicy
        cancelledIun:
          $ref: ./schemas-pn-notification.yaml#/components/schemas/IUN
        physicalCommunicationType:
          type: string
          description: Tipologia comunicazione fisica
          enum:
            - AR_REGISTERED_LETTER
            - REGISTERED_LETTER_890
        senderDenomination:
          $ref: ./schemas-pn-notification.yaml#/components/schemas/Denomination
        senderTaxId:
          $ref: ./schemas-pn-notification.yaml#/components/schemas/paTaxId
        group:
          type: string
          description: Gruppo di utenti dell'ente mittente che può visualizzare la notifica
          pattern: ^[ -~]*$
          maxLength: 1024
        amount:
          type: integer
          format: int32
          description: Importo della notifica in eurocent
        paymentExpirationDate:
          type: string
          minLength: 10
          maxLength: 10
          pattern: ^([0-9]{4})-(1[0-2]|0[1-9])-(3[01]|[12][0-9]|0[1-9])$
          description: >-
            Data di scadenza del pagamento nel formato YYYY-MM-DD riferito
            all'Italia
        taxonomyCode:
          type: string
          minLength: 7
          maxLength: 7
          pattern: ^([0-9]{6}[A-Z]{1})$
          description: >-
            Codice tassonomico della notifica basato sulla definizione presente
            nell'allegato 2 capitolo C del bando [__AVVISO PUBBLICO MISURA 1.4.5
            PIATTAFORMA NOTIFICHE
            DIGITALI__](https://pnrrcomuni.fondazioneifel.it/bandi_public/Bando/325)
        paFee:
          $ref: ./schemas-pn-notification.yaml#/components/schemas/PaFeeV23
        vat:
          $ref: ./schemas-pn-notification.yaml#/components/schemas/VatV23
        pagoPaIntMode:
          type: string
          description: >-
            Modalitá di integrazione pagoPA per l'attualizazione del costo della
            notifica. <br/> - _NONE_: nessuna attualizzazione. <br/> - _SYNC_:
            modalitá sincrona. <br/> - _ASYNC_: modalitá asincrona. <br/>
          enum:
            - NONE
            - SYNC
            - ASYNC
    NewNotificationRequestV24:
      $ref: >-
        ./schemas-pn-notification-older-version.yaml#/components/schemas/NewNotificationRequestV24
    SentNotificationV21:
      description: Le informazioni riguardanti una richiesta di notifica accettata
      allOf:
        - $ref: '#/components/schemas/NewNotificationRequestV21'
        - type: object
          required:
            - iun
            - sentAt
          properties:
            senderPaId:
              type: string
              description: >-
                Identificativo (non IPA) della PA mittente che ha eseguito
                l'onboarding su SelfCare.
              pattern: ^.*$
              maxLength: 256
            iun:
              $ref: ./schemas-pn-notification.yaml#/components/schemas/IUN
            sentAt:
              type: string
              description: Momento di ricezione della notifica da parte di PN
              format: date-time
            cancelledByIun:
              $ref: ./schemas-pn-notification.yaml#/components/schemas/IUN
            documentsAvailable:
              type: boolean
              description: Indica se i documenti notificati sono ancora disponibili.
    SentNotificationV23:
      description: Le informazioni riguardanti una richiesta di notifica accettata
      allOf:
        - $ref: '#/components/schemas/NewNotificationRequestV23'
        - type: object
          required:
            - iun
            - sentAt
          properties:
            senderPaId:
              type: string
              description: >-
                Identificativo (non IPA) della PA mittente che ha eseguito
                l'onboarding su SelfCare. La risoluzione di questo è ottenibile
                da /ext-registry/pa/v1/activated-on-pn
              pattern: ^.*$
              maxLength: 256
            iun:
              $ref: ./schemas-pn-notification.yaml#/components/schemas/IUN
            sentAt:
              type: string
              description: Momento di ricezione della notifica da parte di PN
              format: date-time
            cancelledByIun:
              $ref: ./schemas-pn-notification.yaml#/components/schemas/IUN
            documentsAvailable:
              type: boolean
              description: Indica se i documenti notificati sono ancora disponibili.
    NewNotificationRequestStatusResponse:
      allOf:
        - $ref: '#/components/schemas/NewNotificationRequest'
        - type: object
          required:
            - notificationRequestId
            - notificationRequestStatus
          properties:
            notificationRequestId:
              description: >-
                identificativo univoco di una richiesta di invio notifica, non è
                lo IUN
              type: string
            notificationRequestStatus:
              description: >-
                - __WAITING__: in attesa di essere valutata - __ACCEPTED__:
                richiesta di notifica accettata, lo IUN è valorizzato -
                __REFUSED__: richiesta di notifica rifiutata, è valorizzato il
                campo _errors_
              type: string
            retryAfter:
              type: integer
              format: int32
              description: >-
                Numero di secondi da attendere prima di effettuare una nuova
                richiesta per  la stessa entità; valorizzato quando lo status è
                __WAITING__.
            iun:
              $ref: ./schemas-pn-notification.yaml#/components/schemas/IUN
            errors:
              description: >-
                Elenco degli errori che hanno causato il rifiuto della richiesta
                di notifica
              type: array
              items:
                $ref: '#/components/schemas/ProblemError'
    NewNotificationRequestStatusResponseV21:
      allOf:
        - $ref: '#/components/schemas/NewNotificationRequestV21'
        - type: object
          required:
            - notificationRequestId
            - notificationRequestStatus
          properties:
            notificationRequestId:
              description: >-
                identificativo univoco di una richiesta di invio notifica, non è
                lo IUN
              type: string
            notificationRequestStatus:
              description: >-
                - __WAITING__: in attesa di essere valutata - __ACCEPTED__:
                richiesta di notifica accettata, lo IUN è valorizzato -
                __REFUSED__: richiesta di notifica rifiutata, è valorizzato il
                campo _errors_
              type: string
            retryAfter:
              type: integer
              format: int32
              description: >-
                Numero di secondi da attendere prima di effettuare una nuova
                richiesta per  la stessa entità; valorizzato quando lo status è
                __WAITING__.
            iun:
              $ref: ./schemas-pn-notification.yaml#/components/schemas/IUN
            errors:
              description: >-
                Elenco degli errori che hanno causato il rifiuto della richiesta
                di notifica
              type: array
              items:
                $ref: '#/components/schemas/ProblemError'
    NewNotificationRequestStatusResponseV23:
      allOf:
        - $ref: '#/components/schemas/NewNotificationRequestV23'
        - type: object
          required:
            - notificationRequestId
            - notificationRequestStatus
          properties:
            notificationRequestId:
              description: >-
                identificativo univoco di una richiesta di invio notifica, non è
                lo IUN
              type: string
            notificationRequestStatus:
              description: >-
                - __WAITING__: in attesa di essere valutata - __ACCEPTED__:
                richiesta di notifica accettata, lo IUN è valorizzato -
                __REFUSED__: richiesta di notifica rifiutata, è valorizzato il
                campo _errors_
              type: string
            retryAfter:
              type: integer
              format: int32
              description: >-
                Numero di secondi da attendere prima di effettuare una nuova
                richiesta per  la stessa entità; valorizzato quando lo status è
                __WAITING__.
            iun:
              $ref: ./schemas-pn-notification.yaml#/components/schemas/IUN
            errors:
              description: >-
                Elenco degli errori che hanno causato il rifiuto della richiesta
                di notifica
              type: array
              items:
                $ref: '#/components/schemas/ProblemError'
    NewNotificationRequestStatusResponseV24:
      $ref: >-
        ./schemas-pn-notification-older-version.yaml#/components/schemas/NewNotificationRequestStatusResponseV24
    FullSentNotification:
      description: >-
        Le informazioni riguardanti una notifica (richiesta di notifica
        accettata) e il  processo di inoltro della notifica verso il cittadino.
      allOf:
        - $ref: '#/components/schemas/SentNotification'
        - type: object
          required:
            - notificationStatus
            - notificationStatusHistory
            - timeline
          properties:
            notificationStatus:
              $ref: '#/components/schemas/NotificationStatus'
            notificationStatusHistory:
              $ref: '#/components/schemas/NotificationStatusHistory'
            timeline:
              description: >-
                elenco dettagliato di tutto ciò che è accaduto durrante il
                processo di notifica
              type: array
              items:
                $ref: '#/components/schemas/TimelineElement'
    FullSentNotificationV20:
      description: >-
        Le informazioni riguardanti una notifica (richiesta di notifica
        accettata) e il  processo di inoltro della notifica verso il cittadino.
      allOf:
        - $ref: '#/components/schemas/SentNotification'
        - type: object
          required:
            - notificationStatus
            - notificationStatusHistory
            - timeline
          properties:
            notificationStatus:
              $ref: '#/components/schemas/NotificationStatus'
            notificationStatusHistory:
              $ref: '#/components/schemas/NotificationStatusHistory'
            timeline:
              description: >-
                elenco dettagliato di tutto ciò che è accaduto durrante il
                processo di notifica
              type: array
              items:
                $ref: '#/components/schemas/TimelineElementV20'
    FullSentNotificationV21:
      description: >-
        Le informazioni riguardanti una notifica (richiesta di notifica
        accettata) e il processo di inoltro della notifica verso il cittadino.
      allOf:
        - $ref: '#/components/schemas/SentNotificationV21'
        - type: object
          required:
            - notificationStatus
            - notificationStatusHistory
            - timeline
          properties:
            notificationStatus:
              $ref: '#/components/schemas/NotificationStatus'
            notificationStatusHistory:
              $ref: '#/components/schemas/NotificationStatusHistory'
            timeline:
              description: >-
                elenco dettagliato di tutto ciò che è accaduto durrante il
                processo di notifica
              type: array
              items:
                $ref: '#/components/schemas/TimelineElementV20'
    FullSentNotificationV23:
      description: >-
        Le informazioni riguardanti una notifica (richiesta di notifica
        accettata) e il  processo di inoltro della notifica verso il cittadino.
      allOf:
        - $ref: '#/components/schemas/SentNotificationV23'
        - type: object
          required:
            - notificationStatus
            - notificationStatusHistory
            - timeline
          properties:
            notificationStatus:
              $ref: '#/components/schemas/NotificationStatus'
            notificationStatusHistory:
              $ref: '#/components/schemas/NotificationStatusHistory'
            timeline:
              description: >-
                elenco dettagliato di tutto ciò che è accaduto durrante il
                processo di notifica
              type: array
              items:
                $ref: '#/components/schemas/TimelineElementV23'
    FullSentNotificationV24:
      description: >-
        Le informazioni riguardanti una notifica (richiesta di notifica
        accettata) e il  processo di inoltro della notifica verso il cittadino.
      allOf:
        - $ref: '#/components/schemas/SentNotificationV23'
        - type: object
          required:
            - notificationStatus
            - notificationStatusHistory
            - timeline
          properties:
            notificationStatus:
              $ref: '#/components/schemas/NotificationStatus'
            notificationStatusHistory:
              $ref: '#/components/schemas/NotificationStatusHistory'
            timeline:
              description: >-
                elenco dettagliato di tutto ciò che è accaduto durrante il
                processo di notifica
              type: array
              items:
                $ref: '#/components/schemas/TimelineElementV24'
    FullSentNotificationV25:
      description: >-
        Le informazioni riguardanti una notifica (richiesta di notifica
        accettata) e il  processo di inoltro della notifica verso il cittadino.
      allOf:
        - $ref: '#/components/schemas/SentNotificationV24'
        - type: object
          required:
            - notificationStatus
            - notificationStatusHistory
            - timeline
          properties:
            notificationStatus:
              $ref: '#/components/schemas/NotificationStatus'
            notificationStatusHistory:
              $ref: '#/components/schemas/NotificationStatusHistory'
            timeline:
              description: >-
                elenco dettagliato di tutto ciò che è accaduto durrante il
                processo di notifica
              type: array
              items:
                $ref: '#/components/schemas/TimelineElementV25'
    SentNotificationV24:
      $ref: >-
        ./schemas-pn-notification-older-version.yaml#/components/schemas/SentNotificationV24
    FullSentNotificationV26:
      $ref: >-
        ./schemas-pn-notification-older-version.yaml#/components/schemas/FullSentNotificationV26
    PaFeeV21:
      type: integer
      description: >-
        Costo espresso in eurocent che la PA imputa per la notifica. <br/>
        Obbligatoria per notifiche con notificationFeePolicy=DELIVERY_MODE e
        modalità di integrazione Async o modalità di pagamento F24.<br/> Il
        default nei casi di non obbligatorietà è 100 <br/> Esempio paFee ad 1€
        -> 100 <br/>
      format: int32
      minimum: 0
      maximum: 100
    VatV21:
      type: integer
      description: >-
        IVA espressa in percentuale imposta al mittente sulla notifica
        analogica. <br/> Obbligatoria per notifiche con
        notificationFeePolicy=DELIVERY_MODE e modalità di integrazione Async o
        modalità di pagamento F24.<br/> Il default nei casi di non
        obbligatorietà è 22 <br/> Per rispettare retro-compatibilitá campo non
        restituito nelle API v2.1 <br/> Esempio vat al 22% -> 22 <br/>
      format: int32
      minimum: 0
      maximum: 100
    NotificationRecipient:
      description: Informazioni sui destinatari
      required:
        - denomination
        - recipientType
        - taxId
        - physicalAddress
      type: object
      properties:
        recipientType:
          type: string
          description: >-
            Tipologia di destinatario: Persona Fisica (PF) o Persona Giuridica
            (PG)
          enum:
            - PF
            - PG
        taxId:
          $ref: ./schemas-pn-notification.yaml#/components/schemas/TaxId
        denomination:
          $ref: ./schemas-pn-notification.yaml#/components/schemas/Denomination
        digitalDomicile:
          $ref: >-
            ./schemas-pn-notification.yaml#/components/schemas/NotificationDigitalAddress
        physicalAddress:
          $ref: >-
            ./schemas-pn-notification.yaml#/components/schemas/NotificationPhysicalAddress
        payment:
          $ref: >-
            ./schemas-pn-notification.yaml#/components/schemas/NotificationPaymentInfo
    NotificationRecipientV21:
      description: Informazioni sui destinatari
      required:
        - denomination
        - recipientType
        - taxId
        - physicalAddress
      type: object
      additionalProperties: false
      properties:
        recipientType:
          type: string
          description: >-
            Tipologia di destinatario: Persona Fisica (PF) o Persona Giuridica
            (PG)
          enum:
            - PF
            - PG
        taxId:
          $ref: ./schemas-pn-notification.yaml#/components/schemas/TaxId
        denomination:
          $ref: ./schemas-pn-notification.yaml#/components/schemas/Denomination
        digitalDomicile:
          $ref: >-
            ./schemas-pn-notification.yaml#/components/schemas/NotificationDigitalAddress
        physicalAddress:
          $ref: >-
            ./schemas-pn-notification.yaml#/components/schemas/NotificationPhysicalAddress
        payments:
          $ref: >-
            ./schemas-pn-notification.yaml#/components/schemas/NotificationPayments
    TimelineElement:
      $ref: ./remote-refs.yaml#/components/schemas/TimelineElement
    TimelineElementV20:
      $ref: ./remote-refs.yaml#/components/schemas/TimelineElementV20
    TimelineElementV23:
      $ref: ./remote-refs.yaml#/components/schemas/TimelineElementV23
    TimelineElementV24:
      $ref: ./remote-refs.yaml#/components/schemas/TimelineElementV24
    TimelineElementV25:
      $ref: ./remote-refs.yaml#/components/schemas/TimelineElementV25
    NotificationStatus:
      $ref: ./remote-refs.yaml#/components/schemas/NotificationStatus
    NotificationStatusHistory:
      $ref: ./remote-refs.yaml#/components/schemas/NotificationStatusHistory
  securitySchemes:
    ApiKeyAuth:
      type: apiKey
      in: header
      name: x-api-key
security:
  - ApiKeyAuth: []
